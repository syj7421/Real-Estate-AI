{"ast":null,"code":"var _jsxFileName = \"/Users/jungsooyoung/Documents/software modelling/Amenity-Scope/amenity-scope/src/hooks/useGoogleMap.js\",\n  _s = $RefreshSig$();\n/* global google */\nimport { useEffect, useRef } from 'react';\nimport { Loader } from '@googlemaps/js-api-loader';\nimport CustomerMarker from '../components/Map/CustomMarker';\nimport ReactDOMServer from 'react-dom/server';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CATEGORY_TYPES_MAP = {\n  education: ['school', 'university', 'college'],\n  grocery: ['supermarket', 'grocery_store'],\n  transport: ['train_station', 'bus_station', 'transit_station', 'light_rail_station', 'subway_station'],\n  medical: ['hospital'],\n  green: ['park', 'state_park', 'natural_feature'],\n  culture: ['museum', 'tourist_attraction', 'library', 'art_gallery', 'movie_theater', 'theater', 'concert_hall', 'stadium']\n};\nconst getTypesFromCategories = categories => {\n  if (categories.includes('all')) {\n    return Object.values(CATEGORY_TYPES_MAP).flat();\n  }\n  return categories.flatMap(cat => CATEGORY_TYPES_MAP[cat] || []);\n};\nconst useGoogleMap = (mapRef, onLocationSelect, onPlacesUpdate, selectedCategories) => {\n  _s();\n  const mapInstance = useRef(null);\n  const markerInstance = useRef(null);\n  const nearbyMarkersRef = useRef([]);\n  useEffect(() => {\n    const loader = new Loader({\n      apiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n      version: 'weekly'\n    });\n    loader.load().then(async () => {\n      const {\n        Map\n      } = await google.maps.importLibrary('maps');\n      const {\n        AdvancedMarkerElement\n      } = await google.maps.importLibrary('marker');\n      const {\n        Place,\n        SearchNearbyRankPreference\n      } = await google.maps.importLibrary('places');\n      const melbourneCBD = {\n        lat: -37.8136,\n        lng: 144.9631\n      };\n      const map = new Map(mapRef.current, {\n        center: melbourneCBD,\n        zoom: 14,\n        mapId: 'feabc4fd011254f284cca2c8'\n      });\n      mapInstance.current = map;\n      map.addListener('click', async event => {\n        const clickedLocation = event.latLng;\n        onLocationSelect(clickedLocation);\n        if (markerInstance.current) {\n          markerInstance.current.position = clickedLocation;\n        } else {\n          markerInstance.current = new AdvancedMarkerElement({\n            position: clickedLocation,\n            map\n          });\n        }\n        nearbyMarkersRef.current.forEach(marker => marker.map = null);\n        nearbyMarkersRef.current = [];\n        const includedTypes = getTypesFromCategories(selectedCategories);\n        const request = {\n          locationRestriction: {\n            center: clickedLocation,\n            radius: 800\n          },\n          fields: ['displayName', 'location', 'businessStatus', 'types', 'rating', 'userRatingCount'],\n          includedPrimaryTypes: includedTypes,\n          maxResultCount: 50,\n          rankPreference: SearchNearbyRankPreference.POPULARITY,\n          language: 'en-AU'\n        };\n        const {\n          places\n        } = await Place.searchNearby(request);\n        let filteredPlaces = places;\n        if (selectedCategories.includes('all')) {\n          filteredPlaces = places.filter(p => p.userRatingCount > 0).sort((a, b) => b.userRatingCount - a.userRatingCount).slice(0, 20);\n        }\n        if (filteredPlaces.length) {\n          filteredPlaces.forEach((place, index) => {\n            const markerHTML = ReactDOMServer.renderToStaticMarkup(/*#__PURE__*/_jsxDEV(CustomerMarker, {\n              number: index + 1\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 15\n            }, this));\n            const wrapper = document.createElement('div');\n            wrapper.innerHTML = markerHTML;\n            const marker = new AdvancedMarkerElement({\n              map,\n              position: place.location,\n              title: place.displayName,\n              content: wrapper.firstChild\n            });\n            nearbyMarkersRef.current.push(marker);\n          });\n          onPlacesUpdate(filteredPlaces);\n        } else {\n          console.log('No nearby places found.');\n        }\n      });\n    });\n  }, [mapRef, onLocationSelect, onPlacesUpdate, selectedCategories]);\n};\n_s(useGoogleMap, \"WtYCwMYtvr0vBRjkZwuDREBJKRY=\");\nexport default useGoogleMap;","map":{"version":3,"names":["useEffect","useRef","Loader","CustomerMarker","ReactDOMServer","jsxDEV","_jsxDEV","CATEGORY_TYPES_MAP","education","grocery","transport","medical","green","culture","getTypesFromCategories","categories","includes","Object","values","flat","flatMap","cat","useGoogleMap","mapRef","onLocationSelect","onPlacesUpdate","selectedCategories","_s","mapInstance","markerInstance","nearbyMarkersRef","loader","apiKey","process","env","REACT_APP_GOOGLE_MAPS_API_KEY","version","load","then","Map","google","maps","importLibrary","AdvancedMarkerElement","Place","SearchNearbyRankPreference","melbourneCBD","lat","lng","map","current","center","zoom","mapId","addListener","event","clickedLocation","latLng","position","forEach","marker","includedTypes","request","locationRestriction","radius","fields","includedPrimaryTypes","maxResultCount","rankPreference","POPULARITY","language","places","searchNearby","filteredPlaces","filter","p","userRatingCount","sort","a","b","slice","length","place","index","markerHTML","renderToStaticMarkup","number","fileName","_jsxFileName","lineNumber","columnNumber","wrapper","document","createElement","innerHTML","location","title","displayName","content","firstChild","push","console","log"],"sources":["/Users/jungsooyoung/Documents/software modelling/Amenity-Scope/amenity-scope/src/hooks/useGoogleMap.js"],"sourcesContent":["/* global google */\nimport { useEffect, useRef } from 'react';\nimport { Loader } from '@googlemaps/js-api-loader';\nimport CustomerMarker from '../components/Map/CustomMarker';\nimport ReactDOMServer from 'react-dom/server';\n\nconst CATEGORY_TYPES_MAP = {\n  education: ['school', 'university', 'college'],\n  grocery: ['supermarket', 'grocery_store'],\n  transport: ['train_station', 'bus_station', 'transit_station', 'light_rail_station', 'subway_station'],\n  medical: ['hospital'],\n  green: ['park', 'state_park', 'natural_feature'],\n  culture: ['museum', 'tourist_attraction', 'library', 'art_gallery', 'movie_theater', 'theater', 'concert_hall', 'stadium'],\n};\n\nconst getTypesFromCategories = (categories) => {\n  if (categories.includes('all')) {\n    return Object.values(CATEGORY_TYPES_MAP).flat();\n  }\n  return categories.flatMap(cat => CATEGORY_TYPES_MAP[cat] || []);\n};\n\nconst useGoogleMap = (mapRef, onLocationSelect, onPlacesUpdate, selectedCategories) => {\n  const mapInstance = useRef(null);\n  const markerInstance = useRef(null);\n  const nearbyMarkersRef = useRef([]);\n\n  useEffect(() => {\n    const loader = new Loader({\n      apiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n      version: 'weekly',\n    });\n\n    loader.load().then(async () => {\n      const { Map } = await google.maps.importLibrary('maps');\n      const { AdvancedMarkerElement } = await google.maps.importLibrary('marker');\n      const { Place, SearchNearbyRankPreference } = await google.maps.importLibrary('places');\n\n      const melbourneCBD = { lat: -37.8136, lng: 144.9631 };\n      const map = new Map(mapRef.current, {\n        center: melbourneCBD,\n        zoom: 14,\n        mapId: 'feabc4fd011254f284cca2c8',\n      });\n\n      mapInstance.current = map;\n\n      map.addListener('click', async (event) => {\n        const clickedLocation = event.latLng;\n        onLocationSelect(clickedLocation);\n\n        if (markerInstance.current) {\n          markerInstance.current.position = clickedLocation;\n        } else {\n          markerInstance.current = new AdvancedMarkerElement({\n            position: clickedLocation,\n            map,\n          });\n        }\n\n        nearbyMarkersRef.current.forEach(marker => marker.map = null);\n        nearbyMarkersRef.current = [];\n\n        const includedTypes = getTypesFromCategories(selectedCategories);\n\n        const request = {\n          locationRestriction: {\n            center: clickedLocation,\n            radius: 800,\n          },\n          fields: ['displayName', 'location', 'businessStatus', 'types', 'rating', 'userRatingCount'],\n          includedPrimaryTypes: includedTypes,\n          maxResultCount: 50,\n          rankPreference: SearchNearbyRankPreference.POPULARITY,\n          language: 'en-AU',\n        };\n\n        const { places } = await Place.searchNearby(request);\n\n        let filteredPlaces = places;\n        if (selectedCategories.includes('all')) {\n          filteredPlaces = places\n            .filter(p => p.userRatingCount > 0)\n            .sort((a, b) => b.userRatingCount - a.userRatingCount)\n            .slice(0, 20);\n        }\n\n        if (filteredPlaces.length) {\n          filteredPlaces.forEach((place, index) => {\n            const markerHTML = ReactDOMServer.renderToStaticMarkup(\n              <CustomerMarker number={index + 1} />\n            );\n\n            const wrapper = document.createElement('div');\n            wrapper.innerHTML = markerHTML;\n\n            const marker = new AdvancedMarkerElement({\n              map,\n              position: place.location,\n              title: place.displayName,\n              content: wrapper.firstChild,\n            });\n\n            nearbyMarkersRef.current.push(marker);\n          });\n\n          onPlacesUpdate(filteredPlaces);\n        } else {\n          console.log('No nearby places found.');\n        }\n      });\n    });\n  }, [mapRef, onLocationSelect, onPlacesUpdate, selectedCategories]);\n};\n\nexport default useGoogleMap;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"var _s = $RefreshSig$();\n/* global google */\nimport { useEffect, useRef } from 'react';\nimport { Loader } from '@googlemaps/js-api-loader';\nimport { CustomerMarker } from '../components/Map/\bCustomMarker';\nconst useGoogleMap = mapRef => {\n  _s();\n  const mapInstance = useRef(null);\n  const markerInstance = useRef(null);\n  const nearbyMarkersRef = useRef([]); // 기존 마커들 저장\n\n  useEffect(() => {\n    const loader = new Loader({\n      apiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n      version: 'weekly'\n    });\n    loader.load().then(async () => {\n      const {\n        Map\n      } = await google.maps.importLibrary('maps');\n      const {\n        AdvancedMarkerElement\n      } = await google.maps.importLibrary('marker');\n      const {\n        Place,\n        SearchNearbyRankPreference\n      } = await google.maps.importLibrary('places');\n      const melbourneCBD = {\n        lat: -37.8136,\n        lng: 144.9631\n      };\n      const map = new Map(mapRef.current, {\n        center: melbourneCBD,\n        zoom: 14,\n        mapId: 'feabc4fd011254f284cca2c8'\n      });\n      mapInstance.current = map;\n      map.addListener('click', async event => {\n        const clickedLocation = event.latLng;\n\n        // 선택 마커 생성/이동\n        if (markerInstance.current) {\n          markerInstance.current.position = clickedLocation;\n        } else {\n          markerInstance.current = new AdvancedMarkerElement({\n            position: clickedLocation,\n            map\n          });\n        }\n\n        // 기존 마커 삭제\n        nearbyMarkersRef.current.forEach(marker => marker.map = null);\n        nearbyMarkersRef.current = [];\n\n        // 검색 요청 구성\n        const request = {\n          locationRestriction: {\n            center: clickedLocation,\n            radius: 800\n          },\n          fields: ['displayName', 'location', 'businessStatus'],\n          includedPrimaryTypes: ['restaurant', 'cafe', 'convenience_store', 'school'],\n          maxResultCount: 20,\n          rankPreference: SearchNearbyRankPreference.DISTANCE,\n          language: 'en-AU'\n        };\n\n        // 검색 수행\n        const {\n          places\n        } = await Place.searchNearby(request);\n        if (places.length) {\n          places.forEach(place => {\n            const marker = new AdvancedMarkerElement({\n              map,\n              position: place.location,\n              title: place.displayName\n            });\n            nearbyMarkersRef.current.push(marker);\n          });\n        } else {\n          console.log('No nearby places found.');\n        }\n      });\n    });\n  }, [mapRef]);\n};\n_s(useGoogleMap, \"WtYCwMYtvr0vBRjkZwuDREBJKRY=\");\nexport default useGoogleMap;","map":{"version":3,"names":["useEffect","useRef","Loader","CustomerMarker","useGoogleMap","mapRef","_s","mapInstance","markerInstance","nearbyMarkersRef","loader","apiKey","process","env","REACT_APP_GOOGLE_MAPS_API_KEY","version","load","then","Map","google","maps","importLibrary","AdvancedMarkerElement","Place","SearchNearbyRankPreference","melbourneCBD","lat","lng","map","current","center","zoom","mapId","addListener","event","clickedLocation","latLng","position","forEach","marker","request","locationRestriction","radius","fields","includedPrimaryTypes","maxResultCount","rankPreference","DISTANCE","language","places","searchNearby","length","place","location","title","displayName","push","console","log"],"sources":["/Users/jungsooyoung/Documents/software modelling/Amenity-Scope/amenity-scope/src/hooks/useGoogleMap.js"],"sourcesContent":["/* global google */\nimport { useEffect, useRef } from 'react';\nimport { Loader } from '@googlemaps/js-api-loader';\nimport {CustomerMarker} from '../components/Map/\bCustomMarker';\n\nconst useGoogleMap = (mapRef) => {\n  const mapInstance = useRef(null);\n  const markerInstance = useRef(null);\n  const nearbyMarkersRef = useRef([]); // 기존 마커들 저장\n\n  useEffect(() => {\n    const loader = new Loader({\n      apiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n      version: 'weekly',\n    });\n\n    loader.load().then(async () => {\n      const { Map } = await google.maps.importLibrary('maps');\n      const { AdvancedMarkerElement } = await google.maps.importLibrary('marker');\n      const { Place, SearchNearbyRankPreference } = await google.maps.importLibrary('places');\n\n      const melbourneCBD = { lat: -37.8136, lng: 144.9631 };\n      const map = new Map(mapRef.current, {\n        center: melbourneCBD,\n        zoom: 14,\n        mapId: 'feabc4fd011254f284cca2c8',\n      });\n\n      mapInstance.current = map;\n\n      map.addListener('click', async (event) => {\n        const clickedLocation = event.latLng;\n\n        // 선택 마커 생성/이동\n        if (markerInstance.current) {\n          markerInstance.current.position = clickedLocation;\n        } else {\n          markerInstance.current = new AdvancedMarkerElement({\n            position: clickedLocation,\n            map,\n          });\n        }\n\n        // 기존 마커 삭제\n        nearbyMarkersRef.current.forEach(marker => marker.map = null);\n        nearbyMarkersRef.current = [];\n\n        // 검색 요청 구성\n        const request = {\n          locationRestriction: {\n            center: clickedLocation,\n            radius: 800,\n          },\n          fields: ['displayName', 'location', 'businessStatus'],\n          includedPrimaryTypes: ['restaurant', 'cafe', 'convenience_store', 'school'],\n          maxResultCount: 20,\n          rankPreference: SearchNearbyRankPreference.DISTANCE,\n          language: 'en-AU',\n        };\n\n        // 검색 수행\n        const { places } = await Place.searchNearby(request);\n\n        if (places.length) {\n          places.forEach(place => {\n            const marker = new AdvancedMarkerElement({\n              map,\n              position: place.location,\n              title: place.displayName,\n            });\n            nearbyMarkersRef.current.push(marker);\n          });\n        } else {\n          console.log('No nearby places found.');\n        }\n      });\n    });\n  }, [mapRef]);\n};\n\nexport default useGoogleMap;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
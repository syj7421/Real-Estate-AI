{"ast":null,"code":"var _jsxFileName = \"/Users/jungsooyoung/Documents/software modelling/Amenity-Scope/amenity-scope/src/utils/searchNearbyAmenities.js\";\n/* global google */\nimport ReactDOMServer from 'react-dom/server';\nimport CustomerMarker from '../components/Map/\bCustomMarker';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport async function searchNearbyAmenities({\n  map,\n  clickedLocation,\n  radius,\n  includedPrimaryTypes\n}) {\n  const {\n    Place,\n    SearchNearbyRankPreference\n  } = await google.maps.importLibrary('places');\n  const {\n    AdvancedMarkerElement\n  } = await google.maps.importLibrary('marker');\n  const request = {\n    locationRestriction: {\n      center: clickedLocation,\n      radius\n    },\n    fields: ['displayName', 'location', 'businessStatus', 'types', 'rating', 'userRatingCount'],\n    // 추가\n    includedPrimaryTypes,\n    maxResultCount: 20,\n    rankPreference: SearchNearbyRankPreference.POPULARITY,\n    language: 'en-AU'\n  };\n  const {\n    places\n  } = await Place.searchNearby(request);\n\n  // ✅ 필터링\n  const filteredPlaces = places.filter(place => {\n    var _place$userRatingCoun, _place$rating;\n    return place.businessStatus === 'OPERATIONAL' && ((_place$userRatingCoun = place.userRatingCount) !== null && _place$userRatingCoun !== void 0 ? _place$userRatingCoun : 0) >= 0 && ((_place$rating = place.rating) !== null && _place$rating !== void 0 ? _place$rating : 0) >= 3.8;\n  });\n  const markers = [];\n  if (filteredPlaces.length) {\n    filteredPlaces.forEach((place, index) => {\n      const markerHTML = ReactDOMServer.renderToStaticMarkup(/*#__PURE__*/_jsxDEV(CustomerMarker, {\n        number: index + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 9\n      }, this));\n      const wrapper = document.createElement('div');\n      wrapper.innerHTML = markerHTML;\n      const marker = new AdvancedMarkerElement({\n        map,\n        position: place.location,\n        title: place.displayName,\n        content: wrapper.firstChild\n      });\n      markers.push(marker);\n    });\n  }\n  return {\n    places: filteredPlaces,\n    markers\n  };\n}","map":{"version":3,"names":["ReactDOMServer","CustomerMarker","jsxDEV","_jsxDEV","searchNearbyAmenities","map","clickedLocation","radius","includedPrimaryTypes","Place","SearchNearbyRankPreference","google","maps","importLibrary","AdvancedMarkerElement","request","locationRestriction","center","fields","maxResultCount","rankPreference","POPULARITY","language","places","searchNearby","filteredPlaces","filter","place","_place$userRatingCoun","_place$rating","businessStatus","userRatingCount","rating","markers","length","forEach","index","markerHTML","renderToStaticMarkup","number","fileName","_jsxFileName","lineNumber","columnNumber","wrapper","document","createElement","innerHTML","marker","position","location","title","displayName","content","firstChild","push"],"sources":["/Users/jungsooyoung/Documents/software modelling/Amenity-Scope/amenity-scope/src/utils/searchNearbyAmenities.js"],"sourcesContent":["/* global google */\nimport ReactDOMServer from 'react-dom/server';\nimport CustomerMarker from '../components/Map/\bCustomMarker';\n\n\nexport async function searchNearbyAmenities({ map, clickedLocation, radius, includedPrimaryTypes }) {\n  const { Place, SearchNearbyRankPreference } = await google.maps.importLibrary('places');\n  const { AdvancedMarkerElement } = await google.maps.importLibrary('marker');\n\n  const request = {\n    locationRestriction: {\n      center: clickedLocation,\n      radius,\n    },\n    fields: ['displayName', 'location', 'businessStatus', 'types', 'rating', 'userRatingCount'], // 추가\n    includedPrimaryTypes,\n    maxResultCount: 20,\n    rankPreference: SearchNearbyRankPreference.POPULARITY,\n    language: 'en-AU',\n  };\n\n  const { places } = await Place.searchNearby(request);\n\n  // ✅ 필터링\n  const filteredPlaces = places.filter(place =>\n    place.businessStatus === 'OPERATIONAL' &&\n    (place.userRatingCount ?? 0) >= 0 &&\n    (place.rating ?? 0) >= 3.8\n  );\n\n  const markers = [];\n\n  if (filteredPlaces.length) {\n    filteredPlaces.forEach((place, index) => {\n      const markerHTML = ReactDOMServer.renderToStaticMarkup(\n        <CustomerMarker number={index + 1} />\n      );\n      const wrapper = document.createElement('div');\n      wrapper.innerHTML = markerHTML;\n      const marker = new AdvancedMarkerElement({\n        map,\n        position: place.location,\n        title: place.displayName,\n        content: wrapper.firstChild,\n      });\n      markers.push(marker);\n    });\n  }\n\n  return { places: filteredPlaces, markers };\n}"],"mappings":";AAAA;AACA,OAAOA,cAAc,MAAM,kBAAkB;AAC7C,OAAOC,cAAc,MAAM,iCAAiC;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAG7D,OAAO,eAAeC,qBAAqBA,CAAC;EAAEC,GAAG;EAAEC,eAAe;EAAEC,MAAM;EAAEC;AAAqB,CAAC,EAAE;EAClG,MAAM;IAAEC,KAAK;IAAEC;EAA2B,CAAC,GAAG,MAAMC,MAAM,CAACC,IAAI,CAACC,aAAa,CAAC,QAAQ,CAAC;EACvF,MAAM;IAAEC;EAAsB,CAAC,GAAG,MAAMH,MAAM,CAACC,IAAI,CAACC,aAAa,CAAC,QAAQ,CAAC;EAE3E,MAAME,OAAO,GAAG;IACdC,mBAAmB,EAAE;MACnBC,MAAM,EAAEX,eAAe;MACvBC;IACF,CAAC;IACDW,MAAM,EAAE,CAAC,aAAa,EAAE,UAAU,EAAE,gBAAgB,EAAE,OAAO,EAAE,QAAQ,EAAE,iBAAiB,CAAC;IAAE;IAC7FV,oBAAoB;IACpBW,cAAc,EAAE,EAAE;IAClBC,cAAc,EAAEV,0BAA0B,CAACW,UAAU;IACrDC,QAAQ,EAAE;EACZ,CAAC;EAED,MAAM;IAAEC;EAAO,CAAC,GAAG,MAAMd,KAAK,CAACe,YAAY,CAACT,OAAO,CAAC;;EAEpD;EACA,MAAMU,cAAc,GAAGF,MAAM,CAACG,MAAM,CAACC,KAAK;IAAA,IAAAC,qBAAA,EAAAC,aAAA;IAAA,OACxCF,KAAK,CAACG,cAAc,KAAK,aAAa,IACtC,EAAAF,qBAAA,GAACD,KAAK,CAACI,eAAe,cAAAH,qBAAA,cAAAA,qBAAA,GAAI,CAAC,KAAK,CAAC,IACjC,EAAAC,aAAA,GAACF,KAAK,CAACK,MAAM,cAAAH,aAAA,cAAAA,aAAA,GAAI,CAAC,KAAK,GAAG;EAAA,CAC5B,CAAC;EAED,MAAMI,OAAO,GAAG,EAAE;EAElB,IAAIR,cAAc,CAACS,MAAM,EAAE;IACzBT,cAAc,CAACU,OAAO,CAAC,CAACR,KAAK,EAAES,KAAK,KAAK;MACvC,MAAMC,UAAU,GAAGrC,cAAc,CAACsC,oBAAoB,cACpDnC,OAAA,CAACF,cAAc;QAACsC,MAAM,EAAEH,KAAK,GAAG;MAAE;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CACtC,CAAC;MACD,MAAMC,OAAO,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;MAC7CF,OAAO,CAACG,SAAS,GAAGV,UAAU;MAC9B,MAAMW,MAAM,GAAG,IAAIlC,qBAAqB,CAAC;QACvCT,GAAG;QACH4C,QAAQ,EAAEtB,KAAK,CAACuB,QAAQ;QACxBC,KAAK,EAAExB,KAAK,CAACyB,WAAW;QACxBC,OAAO,EAAET,OAAO,CAACU;MACnB,CAAC,CAAC;MACFrB,OAAO,CAACsB,IAAI,CAACP,MAAM,CAAC;IACtB,CAAC,CAAC;EACJ;EAEA,OAAO;IAAEzB,MAAM,EAAEE,cAAc;IAAEQ;EAAQ,CAAC;AAC5C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
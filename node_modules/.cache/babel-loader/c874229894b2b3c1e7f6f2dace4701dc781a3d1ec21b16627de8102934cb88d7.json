{"ast":null,"code":"var _s = $RefreshSig$();\n/* global google */\nimport { useEffect, useRef } from 'react';\nimport { Loader } from '@googlemaps/js-api-loader';\nconst useGoogleMap = mapRef => {\n  _s();\n  const mapInstance = useRef(null);\n  const markerInstance = useRef(null);\n  const nearbyMarkersRef = useRef([]);\n  useEffect(() => {\n    const loader = new Loader({\n      apiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n      version: 'weekly',\n      libraries: ['marker', 'places']\n    });\n    loader.load().then(async () => {\n      const {\n        Map\n      } = await google.maps;\n      const {\n        AdvancedMarkerElement\n      } = await google.maps.importLibrary('marker');\n      const {\n        Place\n      } = await google.maps.importLibrary('places');\n      const melbourneCBD = {\n        lat: -37.8136,\n        lng: 144.9631\n      };\n      const map = new Map(mapRef.current, {\n        center: melbourneCBD,\n        zoom: 14,\n        mapId: 'feabc4fd011254f284cca2c8'\n      });\n      mapInstance.current = map;\n\n      // ‚úÖ ÏïàÏ†ÑÌïú ÎßàÏª§ ÏÉùÏÑ± Ìï®Ïàò Ï†ïÏùò\n      const createSafeMarker = (place, map) => {\n        try {\n          if (!place || typeof place !== 'object' || typeof place.id !== 'string' || !place.location || typeof place.location.lat !== 'number' || typeof place.location.lng !== 'number' || !place.displayName || typeof place.displayName.text !== 'string') {\n            console.warn(\"‚ùå Skipping invalid place:\", place);\n            return null;\n          }\n          return new AdvancedMarkerElement({\n            map,\n            position: {\n              lat: place.location.lat,\n              lng: place.location.lng\n            },\n            title: place.displayName.text\n          });\n        } catch (err) {\n          console.error(\"üî• Error during safe marker creation:\", err);\n          return null;\n        }\n      };\n      map.addListener('click', async event => {\n        const clickedLatLng = {\n          lat: event.latLng.lat(),\n          lng: event.latLng.lng()\n        };\n        if (markerInstance.current) {\n          markerInstance.current.position = clickedLatLng;\n        } else {\n          const newMarker = new AdvancedMarkerElement({\n            position: clickedLatLng,\n            map\n          });\n          markerInstance.current = newMarker;\n        }\n        console.log(\"üìç Clicked location:\", clickedLatLng);\n\n        // Í∏∞Ï°¥ ÎßàÏª§ Ï†úÍ±∞\n        nearbyMarkersRef.current.forEach(marker => marker.map = null);\n        nearbyMarkersRef.current = [];\n        const placeService = new Place();\n        try {\n          const {\n            places\n          } = await placeService.searchNearby({\n            locationRestriction: {\n              center: clickedLatLng,\n              radius: 800\n            },\n            includedPrimaryTypes: ['restaurant', 'cafe'],\n            fields: ['id', 'displayName', 'location'],\n            maxResultCount: 10,\n            language: 'en',\n            region: 'au'\n          });\n          if (!places || !places.length) {\n            console.log('üîé No nearby places found.');\n            return;\n          }\n          console.log('‚úÖ Places fetched:', places.length);\n          const bounds = new google.maps.LatLngBounds();\n          places.forEach((place, index) => {\n            const marker = createSafeMarker(place, map);\n            if (marker) {\n              nearbyMarkersRef.current.push(marker);\n              bounds.extend(marker.position);\n            } else {\n              console.warn(`‚ö†Ô∏è Skipped invalid marker at index ${index}`);\n            }\n          });\n          if (!bounds.isEmpty()) {\n            map.fitBounds(bounds);\n          }\n        } catch (error) {\n          console.error('‚ùå Error during place search:', error);\n        }\n      });\n    });\n  }, [mapRef]);\n};\n_s(useGoogleMap, \"WtYCwMYtvr0vBRjkZwuDREBJKRY=\");\nexport default useGoogleMap;","map":{"version":3,"names":["useEffect","useRef","Loader","useGoogleMap","mapRef","_s","mapInstance","markerInstance","nearbyMarkersRef","loader","apiKey","process","env","REACT_APP_GOOGLE_MAPS_API_KEY","version","libraries","load","then","Map","google","maps","AdvancedMarkerElement","importLibrary","Place","melbourneCBD","lat","lng","map","current","center","zoom","mapId","createSafeMarker","place","id","location","displayName","text","console","warn","position","title","err","error","addListener","event","clickedLatLng","latLng","newMarker","log","forEach","marker","placeService","places","searchNearby","locationRestriction","radius","includedPrimaryTypes","fields","maxResultCount","language","region","length","bounds","LatLngBounds","index","push","extend","isEmpty","fitBounds"],"sources":["/Users/jungsooyoung/Documents/software modelling/Amenity-Scope/amenity-scope/src/hooks/useGoogleMap.js"],"sourcesContent":["/* global google */\nimport { useEffect, useRef } from 'react';\nimport { Loader } from '@googlemaps/js-api-loader';\n\nconst useGoogleMap = (mapRef) => {\n  const mapInstance = useRef(null);\n  const markerInstance = useRef(null);\n  const nearbyMarkersRef = useRef([]);\n\n  useEffect(() => {\n    const loader = new Loader({\n      apiKey: process.env.REACT_APP_GOOGLE_MAPS_API_KEY,\n      version: 'weekly',\n      libraries: ['marker', 'places'],\n    });\n\n    loader.load().then(async () => {\n      const { Map } = await google.maps;\n      const { AdvancedMarkerElement } = await google.maps.importLibrary('marker');\n      const { Place } = await google.maps.importLibrary('places');\n\n      const melbourneCBD = { lat: -37.8136, lng: 144.9631 };\n\n      const map = new Map(mapRef.current, {\n        center: melbourneCBD,\n        zoom: 14,\n        mapId: 'feabc4fd011254f284cca2c8',\n      });\n\n      mapInstance.current = map;\n\n      // ‚úÖ ÏïàÏ†ÑÌïú ÎßàÏª§ ÏÉùÏÑ± Ìï®Ïàò Ï†ïÏùò\n      const createSafeMarker = (place, map) => {\n        try {\n          if (\n            !place ||\n            typeof place !== 'object' ||\n            typeof place.id !== 'string' ||\n            !place.location ||\n            typeof place.location.lat !== 'number' ||\n            typeof place.location.lng !== 'number' ||\n            !place.displayName ||\n            typeof place.displayName.text !== 'string'\n          ) {\n            console.warn(\"‚ùå Skipping invalid place:\", place);\n            return null;\n          }\n\n          return new AdvancedMarkerElement({\n            map,\n            position: {\n              lat: place.location.lat,\n              lng: place.location.lng,\n            },\n            title: place.displayName.text,\n          });\n        } catch (err) {\n          console.error(\"üî• Error during safe marker creation:\", err);\n          return null;\n        }\n      };\n\n      map.addListener('click', async (event) => {\n        const clickedLatLng = {\n          lat: event.latLng.lat(),\n          lng: event.latLng.lng(),\n        };\n\n        if (markerInstance.current) {\n          markerInstance.current.position = clickedLatLng;\n        } else {\n          const newMarker = new AdvancedMarkerElement({\n            position: clickedLatLng,\n            map,\n          });\n          markerInstance.current = newMarker;\n        }\n\n        console.log(\"üìç Clicked location:\", clickedLatLng);\n\n        // Í∏∞Ï°¥ ÎßàÏª§ Ï†úÍ±∞\n        nearbyMarkersRef.current.forEach((marker) => (marker.map = null));\n        nearbyMarkersRef.current = [];\n\n        const placeService = new Place();\n\n        try {\n          const { places } = await placeService.searchNearby({\n            locationRestriction: {\n              center: clickedLatLng,\n              radius: 800,\n            },\n            includedPrimaryTypes: ['restaurant', 'cafe'],\n            fields: ['id', 'displayName', 'location'],\n            maxResultCount: 10,\n            language: 'en',\n            region: 'au',\n          });\n\n          if (!places || !places.length) {\n            console.log('üîé No nearby places found.');\n            return;\n          }\n\n          console.log('‚úÖ Places fetched:', places.length);\n          const bounds = new google.maps.LatLngBounds();\n\n          places.forEach((place, index) => {\n            const marker = createSafeMarker(place, map);\n            if (marker) {\n              nearbyMarkersRef.current.push(marker);\n              bounds.extend(marker.position);\n            } else {\n              console.warn(`‚ö†Ô∏è Skipped invalid marker at index ${index}`);\n            }\n          });\n\n          if (!bounds.isEmpty()) {\n            map.fitBounds(bounds);\n          }\n        } catch (error) {\n          console.error('‚ùå Error during place search:', error);\n        }\n      });\n    });\n  }, [mapRef]);\n};\n\nexport default useGoogleMap;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}